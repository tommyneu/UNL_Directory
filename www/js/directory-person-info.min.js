const profile_input=document.getElementById("profile_input"),profile_editor=document.getElementById("profile_editor"),profile_canvas=document.getElementById("profile_image"),profile_canvas_context=profile_canvas.getContext("2d"),profile_square_scale=document.getElementById("profile_square_scale"),profile_square_pos_x=document.getElementById("profile_square_pos_x"),profile_square_pos_y=document.getElementById("profile_square_pos_y"),profile_square_size=document.getElementById("profile_square_size"),submit_button=document.getElementById("submit_button");let profile_image=new Image,square_size_max=300,square_size=300,square_x_pos=0,square_y_pos=0,pointer_start_x=-1,pointer_start_y=-1;function set_profile_square_pos(){profile_image.width,profile_image.height;profile_square_pos_y.value=(square_y_pos/profile_canvas.height*profile_image.height).toString(),profile_square_pos_x.value=(square_x_pos/profile_canvas.width*profile_image.width).toString(),parseFloat(profile_square_size.value)+parseFloat(profile_square_pos_y.value)>profile_image.height&&(profile_square_pos_y.value=(profile_image.height-parseFloat(profile_square_size.value)).toString()),parseFloat(profile_square_size.value)+parseFloat(profile_square_pos_x.value)>profile_image.width&&(profile_square_pos_x.value=(profile_image.width-parseFloat(profile_square_size.value)).toString())}function set_profile_square_size(){var e=Math.min(profile_image.width,profile_image.height);profile_square_size.value=(profile_square_scale.value/100*e).toString()}function check_and_set_square_bounds(){square_x_pos<=0&&(square_x_pos=0),square_y_pos<=0&&(square_y_pos=0),square_x_pos+square_size>=profile_canvas.width&&(square_x_pos=profile_canvas.width-square_size),square_y_pos+square_size>=profile_canvas.height&&(square_y_pos=profile_canvas.height-square_size)}function draw(){profile_canvas_context.fillStyle="grey",profile_canvas_context.fillRect(0,0,profile_canvas.width,profile_canvas.height),profile_canvas_context.drawImage(profile_image,0,0,profile_canvas.width,profile_canvas.height),profile_canvas_context.strokeStyle="black",profile_canvas_context.lineWidth=4,profile_canvas_context.strokeRect(square_x_pos,square_y_pos,square_size,square_size),profile_canvas_context.strokeStyle="white",profile_canvas_context.lineWidth=2,profile_canvas_context.strokeRect(square_x_pos,square_y_pos,square_size,square_size)}profile_input.addEventListener("change",()=>{if(void 0!==profile_input.files[0]){profile_image=new Image;var e=profile_input.files[0];let _=URL.createObjectURL(e);profile_image.onload=function(){URL.revokeObjectURL(_);var e=profile_image.width/profile_image.height;profile_canvas.width=300,profile_canvas.height=300/e,square_size=Math.min(profile_canvas.width,profile_canvas.height),square_size_max=Math.min(profile_canvas.width,profile_canvas.height),square_x_pos=0,square_y_pos=0,set_profile_square_size(),set_profile_square_pos(),draw(),profile_editor.classList.remove("dcf-d-none"),submit_button.removeAttribute("disabled")},profile_image.src=_}}),profile_square_scale.addEventListener("input",()=>{square_size=profile_square_scale.value/100*square_size_max,check_and_set_square_bounds(),set_profile_square_size(),set_profile_square_pos(),draw()}),profile_square_scale.addEventListener("change",()=>{square_size=profile_square_scale.value/100*square_size_max,check_and_set_square_bounds(),set_profile_square_size(),set_profile_square_pos(),draw()}),profile_canvas.addEventListener("mousedown",e=>{pointer_start_x=e.clientX,pointer_start_y=e.clientY}),profile_canvas.addEventListener("mousemove",e=>{-1!==pointer_start_x&&-1!==pointer_start_y&&(x_diff=pointer_start_x-e.clientX,y_diff=pointer_start_y-e.clientY,square_x_pos-=x_diff,square_y_pos-=y_diff,check_and_set_square_bounds(),pointer_start_x=e.clientX,pointer_start_y=e.clientY,draw())}),profile_canvas.addEventListener("mouseleave",e=>{-1!==pointer_start_x&&-1!==pointer_start_y&&(pointer_start_x=-1,pointer_start_y=-1,set_profile_square_pos())}),profile_canvas.addEventListener("mouseup",e=>{-1!==pointer_start_x&&-1!==pointer_start_y&&(pointer_start_x=-1,pointer_start_y=-1,set_profile_square_pos())}),profile_canvas.addEventListener("keydown",e=>{console.log(e.code);let _=!1;switch(e.code){case"ArrowUp":_=!0,square_y_pos-=2;break;case"ArrowDown":_=!0,square_y_pos+=2;break;case"ArrowLeft":_=!0,square_x_pos-=2;break;case"ArrowRight":_=!0,square_x_pos+=2;break;case"Minus":_=!0,profile_square_scale.value=parseFloat(profile_square_scale.value)-2,square_size=profile_square_scale.value/100*square_size_max;break;case"Equal":_=!0,profile_square_scale.value=parseFloat(profile_square_scale.value)+2,square_size=profile_square_scale.value/100*square_size_max}_&&(e.preventDefault(),check_and_set_square_bounds(),set_profile_square_size(),set_profile_square_pos(),draw())});
//# sourceMappingURL=directory-person-info.min.js.map